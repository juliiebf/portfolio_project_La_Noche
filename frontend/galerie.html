<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Galerie - La Noche Karaoké Paris 9ème</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
 <header>
    <div class="top-header">
      <a href="index.html">
        <img src="images/Design sans titre.png" alt="La Noche Karaoke - Bannière" class="logo-main" />
      </a>
      <nav class="main-nav">
        <ul class="nav-links">
          <li><a href="index.html">Accueil</a></li>
          <li><a href="reservation.html">Réservation</a></li>
          <li><a href="boissons.html">Boissons</a></li>
          <li><a href="chansons.html">Chansons</a></li>
          <li><a href="galerie.html" class="active">Galerie</a></li>
          <li><a href="Votes.html">Evenements</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="landing_page.html">À propos</a></li>
        </ul>
        <a href="#" id="openModal" class="login-btn" style="background-color: #27a2ef; color: black; padding: 0.5rem 1.2rem; font-weight: 700; border-radius: 25px; border: none; text-decoration: none; cursor: pointer;">Se connecter</a>
      </nav>
    </div>
  </header>
  <main>
     <section class="hero-section">
      <div class="hero-content">
        <h1>Galerie</h1>
        <p>Galerie photo et vidéo de nos événements et soirées passées.</p>
      </div>
    </section>
    <!-- Ajout du support photos et vidéos -->
     <div class="media-gallery" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; max-width: 1080px; margin: 2rem auto; padding: 0 1rem;">

        <div style="overflow: hidden; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.4); border: 2px solid rgba(34, 170, 255, 0.3);">
          <img src="images/img1.jpg" alt="Soirée Karaoké La Noche 1" style="width: 100%; height: 190px; object-fit: cover;" />
        </div>
        
        <div style="overflow: hidden; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.4); border: 2px solid rgba(34, 170, 255, 0.3);">
          <img src="images/img2.jpg" alt="Soirée Karaoké La Noche 2" style="width: 100%; height: 190px; object-fit: cover;" />
        </div>
        
        <div style="overflow: hidden; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.4); border: 2px solid rgba(34, 170, 255, 0.3);">
          <video controls style="width: 100%; height: 190px; object-fit: cover;">
            <source src="images/vid1.mp4" type="video/mp4" />
            Votre navigateur ne supporte pas la lecture vidéo.
          </video>
        </div>
        
        <div style="overflow: hidden; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.4); border: 2px solid rgba(34, 170, 255, 0.3);">
          <video controls style="width: 100%; height: 190px; object-fit: cover;">
            <source src="images/vid2.mp4" type="video/mp4" />
            Votre navigateur ne supporte pas la lecture vidéo.
          </video>
        </div>
      </div>
      </div>
  </main>
<footer style="background-color: #10060611; color: #777777; padding: 1rem 2rem; text-align: center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
    <p style="margin: 0 0 0.5rem 0;">© 2025 La Noche Karaoké Paris. Tous droits réservés</p>
    <p style="margin: 0 0 1rem 0;">42 Rue des Martyrs, 75009 Paris | 01 42 82 42 82</p>
    <a href="contact.html" style="color: #22aaff; text-decoration: none; font-weight: 600; font-size: 0.9rem; border: 1px solid transparent; padding: 6px 14px; border-radius: 15px; background: rgba(34, 170, 255, 0.1); transition: background 0.3s, border-color 0.3s;">Contactez-nous</a>
  </footer>

 <!-- Pop-up connexion  -->
  <div class="modal-bg" id="popupLogin">
    <div class="modal-popup">
      <div class="modal-tabs">
        <button class="tab-btn active" id="tabSignIn" type="button">Déjà inscrit</button>
        <button class="tab-btn" id="tabSignUp" type="button">Nouveau compte</button>
      </div>
      <div id="signInForm">
        <h2 class="modal-title">Connexion</h2>
        <form>
          <label for="username">Nom d'utilisateur</label>
          <input type="text" id="username" name="username" autocomplete="username" required />
          <label for="password">Mot de passe</label>
          <input type="password" id="password" name="password" autocomplete="current-password" required />
          <button type="submit" class="modal-btn-main">SE CONNECTER</button>
        </form>
      </div>
      <div id="signUpForm" style="display:none;">
        <h2 class="modal-title">Nouveau compte</h2>
        <form>
          <label for="newusername">Nom d'utilisateur</label>
          <input type="text" id="newusername" name="newusername" autocomplete="username" required />
          <label for="newemail">Email</label>
          <input type="email" id="newemail" name="newemail" autocomplete="email" required />
          <label for="newpassword">Mot de passe</label>
          <input type="password" id="newpassword" name="newpassword" autocomplete="new-password" required />
          <button type="submit" class="modal-btn-main">CRÉER LE COMPTE</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Fonction pour afficher les messages
    function showMessage(message, isError = false) {
      const messageDiv = document.createElement('div');
      messageDiv.textContent = message;
      messageDiv.style.padding = '10px';
      messageDiv.style.margin = '10px 0';
      messageDiv.style.borderRadius = '4px';
      messageDiv.style.textAlign = 'center';
      messageDiv.style.position = 'fixed';
      messageDiv.style.top = '20px';
      messageDiv.style.left = '50%';
      messageDiv.style.transform = 'translateX(-50%)';
      messageDiv.style.zIndex = '1000';
      messageDiv.style.minWidth = '300px';
      messageDiv.style.maxWidth = '80%';
      
      if (isError) {
        messageDiv.style.backgroundColor = '#ffebee';
        messageDiv.style.color = '#c62828';
        messageDiv.style.border = '1px solid #ef9a9a';
      } else {
        messageDiv.style.backgroundColor = '#e8f5e9';
        messageDiv.style.color = '#2e7d32';
        messageDiv.style.border = '1px solid #a5d6a7';
      }

      document.body.appendChild(messageDiv);
      setTimeout(() => {
        messageDiv.style.opacity = '0';
        messageDiv.style.transition = 'opacity 1s';
        setTimeout(() => messageDiv.remove(), 1000);
      }, 3000);
    }

    // Fonction de connexion
    async function login(email, password) {
      try {
        const response = await fetch('http://localhost:3000/api/auth/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, password })
        });

        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.message || 'Erreur de connexion');
        }

        // Stocker le token
        localStorage.setItem('token', data.token);
        showMessage('Connexion réussie !');
        updateAuthUI();
        return data.token;
      } catch (error) {
        showMessage(error.message || 'Une erreur est survenue', true);
        return null;
      }
    }

    // Fonction d'inscription
    async function register(name, email, password) {
      try {
        const response = await fetch('http://localhost:3000/api/auth/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ name, email, password })
        });

        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.message || "Erreur lors de l'inscription");
        }

        showMessage('Inscription réussie ! Vous pouvez maintenant vous connecter.');
        // Basculer vers l'onglet de connexion
        document.getElementById('tabSignIn').click();
        return data.user;
      } catch (error) {
        showMessage(error.message || "Une erreur est survenue lors de l'inscription", true);
        return null;
      }
    }

    // Fonction de déconnexion
    function logout() {
      localStorage.removeItem('token');
      showMessage('Déconnexion réussie');
      updateAuthUI();
      window.location.reload();
    }

    // Mise à jour de l'interface en fonction de l'état de connexion
    function updateAuthUI() {
      const token = localStorage.getItem('token');
      const loginBtn = document.getElementById('openModal');
      
      if (token && loginBtn) {
        // Remplacer le bouton de connexion par un bouton de déconnexion
        loginBtn.outerHTML = `
          <a href="#" id="logoutBtn" class="login-btn" style="background-color: #ff4d4d; color: white; padding: 0.5rem 1.2rem; font-weight: 700; border-radius: 25px; border: none; text-decoration: none; cursor: pointer;" onclick="logout(); return false;">
            Déconnexion
          </a>
        `;
      } else if (loginBtn) {
        // Remettre le bouton de connexion si l'utilisateur n'est pas connecté
        loginBtn.outerHTML = '<a href="#" id="openModal" class="login-btn" style="background-color: #27a2ef; color: black; padding: 0.5rem 1.2rem; font-weight: 700; border-radius: 25px; border: none; text-decoration: none; cursor: pointer;">Se connecter</a>';
        // Réattacher les gestionnaires d'événements
        setupEventListeners();
      }
    }

    // Gestion des événements des formulaires
    function setupEventListeners() {
      // Gestion formulaire connexion
      const signInForm = document.querySelector('#signInForm form');
      if (signInForm) {
        signInForm.addEventListener('submit', async (e) => {
          e.preventDefault();
          const email = document.getElementById('username').value;
          const password = document.getElementById('password').value;
          
          if (!email) {
            showMessage('Le champ email est obligatoire.', true);
            return;
          }
          
          if (!password) {
            showMessage('Le champ mot de passe est obligatoire.', true);
            return;
          }
          
          const token = await login(email, password);
          if (token) {
            document.getElementById('popupLogin').style.display = 'none';
            // Mettre à jour l'interface utilisateur
            updateAuthUI();
          }
        });
      }

      // Gestion formulaire inscription
      const signUpForm = document.querySelector('#signUpForm form');
      if (signUpForm) {
        signUpForm.addEventListener('submit', async (e) => {
          e.preventDefault();
          const name = document.getElementById('newusername').value;
          const email = document.getElementById('newemail').value;
          const password = document.getElementById('newpassword').value;
          const confirmPassword = document.getElementById('newpassword').value;
          
          if (!name || !email || !password || !confirmPassword) {
            showMessage('Tous les champs sont obligatoires.', true);
            return;
          }
          
          if (password !== confirmPassword) {
            showMessage('Les mots de passe ne correspondent pas.', true);
            return;
          }
          
          const user = await register(name, email, password);
          if (user) {
            // Réinitialiser le formulaire
            signUpForm.reset();
          }
        });
      }

      // Gestion des onglets de connexion/inscription
      const tabSignIn = document.getElementById('tabSignIn');
      const tabSignUp = document.getElementById('tabSignUp');
      
      if (tabSignIn) {
        tabSignIn.onclick = function(e) {
          e.preventDefault();
          document.getElementById('signInForm').style.display = 'block';
          document.getElementById('signUpForm').style.display = 'none';
          this.classList.add('active');
          document.getElementById('tabSignUp').classList.remove('active');
        };
      }

      if (tabSignUp) {
        tabSignUp.onclick = function(e) {
          e.preventDefault();
          document.getElementById('signInForm').style.display = 'none';
          document.getElementById('signUpForm').style.display = 'block';
          this.classList.add('active');
          document.getElementById('tabSignIn').classList.remove('active');
        };
      }
    }

    // Initialisation
    document.addEventListener('DOMContentLoaded', () => {
      // Fermer la modale quand on clique en dehors
      const modalBg = document.getElementById('popupLogin');
      if (modalBg) {
        modalBg.addEventListener('click', (e) => {
          if (e.target === modalBg) {
            modalBg.style.display = 'none';
          }
        });
      }

      // Ouvrir la modale de connexion
      const openModalBtn = document.getElementById('openModal');
      if (openModalBtn) {
        openModalBtn.addEventListener('click', (e) => {
          e.preventDefault();
          document.getElementById('popupLogin').style.display = 'flex';
        });
      }

      // Initialiser les gestionnaires d'événements
      setupEventListeners();
      
      // Mettre à jour l'interface utilisateur au chargement
      updateAuthUI();
    });
  </script>
</body>
</html>
